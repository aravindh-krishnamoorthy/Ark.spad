++
++ Conjugate transpose
++
ctranspose(X) ==
    Y := transpose(X)
    for n in rowSlice(Y) repeat for m in colSlice(Y) repeat Y(m,n) := conjugate(Y(m,n))
    Y

++
++ Identity matrix
++
eye(n) == diagonalMatrix [1 for i in 1..n]

++
++ Singular values
++
singularvalues(X) ==
    s := []
    e := solve(X*ctranspose(X) - s*eye(n),s)
    for i in 1..#e repeat s := append(s, sqrt(e(i)))
    s
